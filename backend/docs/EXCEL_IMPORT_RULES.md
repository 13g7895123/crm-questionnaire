# Excel 匯入規則說明

本文件說明 SAQ 範本系統的 Excel 匯入格式規則。

---

## 1. 檔案格式

| 項目 | 說明 |
|------|------|
| 支援格式 | `.xlsx`, `.xls` |
| 資料起始列 | **第 4 列**（前 3 列為表頭，會被忽略） |

---

## 2. 分頁命名規則

每個分頁代表一個 **區段 (Section)**，分頁名稱必須以大寫字母 + `.` 開頭。

> **注意**: 分頁名稱僅顯示英文，中文資訊會從區段標題列取得。

**正確範例**:
- `A. Labor`
- `B. Health and Safety`
- `C. Environment`

**錯誤範例**:
- `勞工` ❌（缺少區段代號）
- `a.labor` ❌（小寫字母）

---

## 3. 編號格式規則

所有編號位於 **B 欄**，系統根據編號格式判斷內容類型。

### 3.1 區段標題
- **格式**: `X. 英文標題 中文標題`
- **位置**: 每個分頁的第一個資料列（第 4 列）
- **用途**: 提供區段的完整中英文名稱
- **範例**: 
  - `A. Labor 勞動`
  - `B. Health and Safety 健康與安全`
  - `C. Environment 環境`

> **解析邏輯**: 分頁名稱 `A. Labor` 提供區段代號，區段標題列 `A. Labor 勞動` 提供完整的中英文標題。

### 3.2 小標題 (Subsection)
- **格式**: `X.n. 標題文字`
- **規則**: 區段代號 + `.` + 數字 + `.` + 空白 + 文字
- **範例**: `A.1. Freely Chosen Employment`

### 3.3 題目 (Question)
- **格式**: `X.n.n`
- **規則**: 區段代號 + `.` + 數字 + `.` + 數字（結尾為數字）
- **範例**: `A.1.1`, `B.2.3`

---

## 4. 題型判定規則

### 4.1 是非題 (BOOLEAN)
- **預設類型**: 所有題目預設為是非題
- **必填**: `true`

### 4.2 表格題 (TABLE)
- **判定條件**: B 欄（編號欄）有合併儲存格
- **結構**:
  - 主題目轉為是非題
  - 若回答 "Yes"，顯示追問表格
  - 表格欄位從 D, E, F... 欄讀取

---

## 5. 欄位對應

| Excel 欄位 | 用途 |
|------------|------|
| B | 編號 (No.) |
| C | 題目文字 (Item) |
| D, E, F... | 表格題欄位標題 |

---

## 6. 範例結構

```
Row | B 欄      | C 欄                    | D 欄
----|-----------|-------------------------|-------
 4  | A.        | Labor                   |
 5  | A.1.      | Freely Chosen Employment|
 6  | A.1.1     | 是否有強制勞動?         |
 7  | A.1.2     | 是否扣押證件?           |
 8  | A.2.      | Working Hours           |
 9  | A.2.1     | 是否超時工作?           |
```

**解析結果**:
- 區段: `A`
- 小標題: `A.1.` (含 2 題), `A.2.` (含 1 題)
- 總題數: 3

---

## 7. 常見問題

### Q1: 為什麼匯入失敗顯示 "未找到符合格式的分頁"？
**原因**: 分頁名稱沒有以 `A.`, `B.` 等格式開頭。
**解法**: 重新命名分頁。

### Q2: 為什麼出現 Duplicate entry 錯誤？
**原因**: 題目編號被誤判為小標題（例如 `C.2.4.1` 被識別為 `C.2.`）。
**解法**: 確認 Excel 編號格式正確，或聯絡開發人員檢查解析器邏輯。
